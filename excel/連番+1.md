スクショありがとうございます 🙏
セルの中身が `001, 002, 003 ...` のように「文字列としての数字（ゼロ埋めあり）」になっていますね。
そのままでは `+1` できないので、以下の手順を使います。

---

## 方法 1. 数式で処理して戻す

1. 例として、A列に `001, 002, 003 ...` があるとします。
2. B1セルに次の数式を入力します：

   ```
   =TEXT(VALUE(A1)+1,"000")
   ```

   * `VALUE(A1)` … 文字列を数値に変換
   * `+1` … 1を足す
   * `TEXT(...,"000")` … 3桁ゼロ埋めで表示
3. 下までオートフィルすれば、すべて `002, 003, 004 ...` になります。
4. B列をコピーして「値の貼り付け」でA列に上書きすれば完了です。

---

## 方法 2. 貼り付け特殊（加算）＋ユーザー定義表示形式

1. 対象のセルをすべて選択。
2. セルの書式設定 → 表示形式 → **ユーザー定義** で `000` を指定。
   （これで数値を3桁ゼロ埋めで表示可能になります）
3. 空きセルに「1」を入力してコピー。
4. 対象セルを選んだ状態で右クリック → 「形式を選択して貼り付け」 → 「演算」から **加算** を選ぶ。
5. すべてのセルが +1 され、表示は `002, 003, 004 ...` のように維持されます。

---

✅ **1回限りなら方法2（貼り付け特殊）**
✅ **何度も処理するなら方法1（数式 → 値貼り付け）** が便利です。

---

質問ですが、この「001, 002...」は **常に3桁固定（000, 001, 002...）** ですか？ それとも将来 4桁や 5桁になる可能性もありますか？


スクショありがとうございます 🙏
今度は **「M-001」, 「M-002」…** のように「文字列の前に固定のプレフィックス（M-）がついている」パターンですね。
この場合も「数値部分だけを抜き出して +1 し、ゼロ埋めして結合」すればOKです。

---

## 方法 1. 数式で処理する

例：A列に `M-001, M-002, …` がある場合

B1セルに次の数式を入力します：

```excel
="M-" & TEXT(VALUE(MID(A1,3,3))+1,"000")
```

* `MID(A1,3,3)` → 3文字目から3桁を取り出す（例: "001"）
* `VALUE(...)` → 数値に変換（例: 1）
* `+1` → 1を足す
* `TEXT(...,"000")` → 3桁ゼロ埋め（例: 002）
* `"M-" & ...` → プレフィックスを結合

👉 結果： `M-002, M-003, …`

必要な範囲にコピーしたあと、値を貼り付けで上書きすれば完了です。

---

## 方法 2. 文字列操作を簡単にする（もし桁数が変わる場合）

もし将来「M-0001」「M-00001」のように桁数が増える可能性があるなら：

```excel
="M-" & TEXT(VALUE(RIGHT(A1,LEN(A1)-2))+1,"000")
```

* `RIGHT(A1,LEN(A1)-2)` → 先頭「M-」を除いた残りを取得（可変桁対応）
* あとは同様に `VALUE → +1 → TEXT` で処理

---

## 方法 3. VBAマクロでまとめて +1

もし飛び飛びセルを一気に更新したい場合はVBAが楽です。

```vba
Sub PlusOne_M_Format()
    Dim cell As Range, num As Long
    For Each cell In Selection
        If cell.Value Like "M-*" Then
            num = CLng(Mid(cell.Value, 3)) + 1
            cell.Value = "M-" & Format(num, "000")
        End If
    Next cell
End Sub
```

👉 選択したセルの `"M-001"` → `"M-002"` のようにすべて +1 されます。

---

✅ **1回だけなら方法1（数式）**
✅ **繰り返し作業なら方法3（VBA）** が便利です。

---

ご質問ですが、この番号は **常に「M-」で固定** でしょうか？ それとも「A-001」「B-001」みたいに、アルファベット部分も変わる可能性がありますか？


良い質問です 👍
「M-001」「M-002」… の間に **空白セルがある場合**、普通に数式を下にコピーすると `#VALUE!` エラーになってしまいます。

---

## ✅ 解決方法：`IF` で空白セルを無視する

B1セルの数式を以下のようにします：

```excel
=IF(A1="","", "M-" & TEXT(VALUE(MID(A1,3,3))+1,"000"))
```

* `IF(A1="","", ...)` → 元セルが空白なら、結果も空白にする
* 空白以外なら通常の処理を実行

---

## ✅ 桁数が変わる可能性がある場合（可変桁対応版）

```excel
=IF(A1="","", "M-" & TEXT(VALUE(RIGHT(A1,LEN(A1)-2))+1,"000"))
```

* `RIGHT(A1,LEN(A1)-2)` → 「M-」以降の文字列を全部取得（桁数が増えてもOK）
* その後に `VALUE → +1 → TEXT(...,"000")`

---

👉 こうすれば **空白セルは空白のまま**、データがあるセルだけ +1 されます。

---

ご確認ですが、この空白セルは「本当に空白」でしょうか？ それとも「見た目は空白でもスペースが入っている」可能性がありますか？
